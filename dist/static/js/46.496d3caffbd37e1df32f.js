webpackJsonp([46],{rPrO:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("woOf"),n=a.n(i),s=a("dPTl"),l=a("cAgV"),r=a("0xDb"),o={name:"complexTable",directives:{waves:l.a},data:function(){return{tableKey:0,list:null,total:null,listLoading:!0,listQuery:{offset:0,limit:20,appName:void 0,published:void 0,ordering:"-id"},importanceOptions:[1,2,3],sortOptions:[{label:"ID Ascending",key:"id"},{label:"ID Descending",key:"-id"}],statusOptions:["published","draft","deleted"],showReviewer:!1,temp:{id:void 0,jsVersion:void 0,jsMD5:void 0,android:void 0,ios:void 0,timestamp:void 0,appName:"",published:!1,jsPath:void 0,showUpdateAlert:!1,changelog:""},dialogFormVisible:!1,dialogStatus:"",textMap:{update:"编辑",create:"新建"},dialogPvVisible:!1,pvData:[],rules:{type:[{required:!0,message:"type is required",trigger:"change"}],timestamp:[{type:"date",required:!0,message:"timestamp is required",trigger:"change"}],title:[{required:!0,message:"title is required",trigger:"blur"}]},downloadLoading:!1}},filters:{statusFilter:function(e){return{published:"success",draft:"info",deleted:"danger"}[e]},typeFilter:function(e){return null}},created:function(){this.getList()},methods:{getList:function(){var e=this;this.listLoading=!0,Object(s.b)(this.listQuery).then(function(t){e.list=t.data.results,e.total=t.data.count,e.listLoading=!1})},handleFilter:function(){this.listQuery.offset=0,this.getList()},handleSizeChange:function(e){this.listQuery.limit=e,this.getList()},handleCurrentChange:function(e){this.listQuery.offset=(e-1)*this.listQuery.limit,this.getList()},handleModifyStatus:function(e,t){this.$message({message:"操作成功",type:"success"}),e.status=t},resetTemp:function(){this.temp={id:void 0,importance:1,remark:"",timestamp:new Date,title:"",status:"published",type:""}},handleCreate:function(){this.$router.push("/package/package-upload")},createData:function(){var e=this;this.$refs.dataForm.validate(function(t){t&&(e.temp.id=parseInt(100*Math.random())+1024,e.temp.author="vue-element-admin")})},handleUpdate:function(e){var t=this;this.temp=n()({},e),this.dialogStatus="update",this.dialogFormVisible=!0,this.$nextTick(function(){t.$refs.dataForm.clearValidate()})},updateData:function(){var e=this;this.$refs.dataForm.validate(function(t){if(t){var a=n()({},e.temp);Object(s.c)(a).then(function(t){e.dialogFormVisible=!1,e.$notify({title:"成功",message:"编辑成功",type:"success",duration:2e3})})}})},handleDelete:function(e){this.$notify({title:"成功",message:"删除成功",type:"success",duration:2e3});var t=this.list.indexOf(e);this.list.splice(t,1)},handleFetchPv:function(e){},handleDownload:function(){var e=this;this.downloadLoading=!0,Promise.all([a.e(2),a.e(61)]).then(a.bind(null,"zWO4")).then(function(t){var a=e.formatJson(["timestamp","title","type","importance","status"],e.list);t.export_json_to_excel({header:["timestamp","title","type","importance","status"],data:a,filename:"table-list"}),e.downloadLoading=!1})},formatJson:function(e,t){return t.map(function(t){return e.map(function(e){return"timestamp"===e?Object(r.b)(t[e]):t[e]})})}}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container calendar-list-container"},[a("div",{staticClass:"filter-container"},[a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:e.$t("package.appName")},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.handleFilter(t)}},model:{value:e.listQuery.appName,callback:function(t){e.$set(e.listQuery,"appName",t)},expression:"listQuery.appName"}}),e._v(" "),a("el-select",{staticClass:"filter-item",staticStyle:{width:"120px"},attrs:{clearable:"",placeholder:e.$t("package.published")},model:{value:e.listQuery.published,callback:function(t){e.$set(e.listQuery,"published",t)},expression:"listQuery.published"}},e._l([1,0],function(e){return a("el-option",{key:e,attrs:{label:e?"是":"否",value:e}})})),e._v(" "),a("el-select",{staticClass:"filter-item",staticStyle:{width:"140px"},on:{change:e.handleFilter},model:{value:e.listQuery.ordering,callback:function(t){e.$set(e.listQuery,"ordering",t)},expression:"listQuery.ordering"}},e._l(e.sortOptions,function(e){return a("el-option",{key:e.key,attrs:{label:e.label,value:e.key}})})),e._v(" "),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleFilter}},[e._v(e._s(e.$t("table.search")))]),e._v(" "),a("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-edit"},on:{click:e.handleCreate}},[e._v(e._s(e.$t("table.add")))])],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],key:e.tableKey,staticStyle:{width:"100%"},attrs:{data:e.list,"element-loading-text":"给我一点时间",border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{align:"center",label:e.$t("package.id"),width:"65"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.id))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:e.$t("package.jsVersion"),width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.jsVersion))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:e.$t("package.jsMD5"),width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.jsMD5))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:e.$t("package.appName"),width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.appName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:e.$t("package.android"),width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.android))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:e.$t("package.ios"),width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.ios))])]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"150px",align:"center",label:e.$t("package.date")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._f("parseTime")(t.row.timestamp,"{y}-{m}-{d} {h}:{i}")))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:e.$t("package.jsPath"),width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.jsPath))])]}}])}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",align:"center",label:e.$t("table.actions"),width:"150","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){e.handleDelete(t.row)}}},[e._v(e._s(e.$t("package.delete")))])]}}])})],1),e._v(" "),a("div",{staticClass:"pagination-container"},[a("el-pagination",{attrs:{background:"","current-page":e.listQuery.page,"page-sizes":[10,20,30,50],"page-size":e.listQuery.limit,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)},staticRenderFns:[]},u=a("VU/8")(o,d,!1,null,null,null);t.default=u.exports}});